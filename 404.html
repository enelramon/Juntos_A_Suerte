<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Juntos_A_Suerte_Wasm</title>
    <base href="/Juntos_A_Suerte_Wasm/" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="manifest.json" rel="manifest" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="_content/Radzen.Blazor/css/material-base.css">
</head>

<body>
    <div id="app">Loading... Cargando....</div>

    <p>Version: <span id="version"></span></p>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">游딏</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>-->
    <script>navigator.serviceWorker.register('service-worker.js');</script>


    <!--Parte del PDF-->
    <script>
        window.GenerarPDF = async (pasante) => {
            var pasantejson = JSON.parse(pasante);

            var pdf = new jsPDF();

            // Crear un objeto Image para el encabezado
            var imgEncabezado = new Image();

            // Cargar la imagen del encabezado
            imgEncabezado.src = "encabezado.png"; // Ruta relativa desde la carpeta wwwroot

            // Evento onload para asegurar que la imagen del encabezado se cargue antes de agregarla al PDF
            imgEncabezado.onload = function () {
                // Agregar la imagen del encabezado al PDF
                pdf.addImage(imgEncabezado, 'PNG', -5, 0, 215, 70); // Ajusta las coordenadas y el tama침o seg칰n tus necesidades

                // Crear un objeto Image para el pie de p치gina
                var imgPieDePagina = new Image();

                // Cargar la imagen del pie de p치gina
                imgPieDePagina.src = "pieDePagina.jpg"; // Ruta relativa desde la carpeta wwwroot

                // Evento onload para asegurar que la imagen del pie de p치gina se cargue antes de agregarla al PDF
                imgPieDePagina.onload = async function () {
                    // Agregar la imagen del pie de p치gina al PDF
                    pdf.addImage(imgPieDePagina, 0, pdf.internal.pageSize.height - 30, 210, 30); // Ajusta las coordenadas y el tama침o seg칰n tus necesidades

                    // Crear un objeto Image para el t칤tulo
                    var imgTitulo = new Image();

                    // Cargar la imagen del t칤tulo
                    imgTitulo.src = "titulo.png"; // Ruta relativa desde la carpeta wwwroot

                    // Evento onload para asegurar que la imagen del t칤tulo se cargue antes de agregarla al PDF
                    imgTitulo.onload = async function () {
                        // Agregar la imagen del t칤tulo al PDF
                        pdf.addImage(imgTitulo, 'PNG', 35, 40, 150, 30); // Ajusta las coordenadas y el tama침o seg칰n tus necesidades

                        // Generar el contenido del PDF
                        pdf.setFont("times"); // Cambiar la fuente a "times"
                        pdf.setFontSize(14); // Establecer el tama침o de la fuente en 14
                        pdf.setTextColor(0, 0, 0); // Color negro

                        // Texto de la carta
                        var textoCarta = `Mediante la presente Acta se Certifica que el estudiante ${pasantejson.Nombres}, titular de la c칠dula de identidad N췈 ${pasantejson.Cedula}, estudiante de la carrera de ${pasantejson.Carrera}, matr칤cula ${pasantejson.Matricula}, de la Universidad Cat칩lica Nordestana de San Francisco de Macor칤s, desempe침칩 y desarroll칩 satisfactoriamente la totalidad de las Actividades y Tareas programadas en su plan de Actividades durante su ${pasantejson.Pasantia} en esta Empresa, efectuada y concluida en el per칤odo comprendido desde el d칤a ${formatDate(new Date(pasantejson.FechaInicio))} hasta el ${formatDate(new Date(pasantejson.FechaFinal))}, ambas fechas inclusive. Acumulando un total de ${pasantejson.CantidadHoras} horas de pr치cticas. Este certificado se expide a solicitud de la parte interesada, a los tres (03) d칤as del mes de ${formatMonthAndYear(new Date(pasantejson.FechaExpide))}.`;

                        // Dividir el texto en l칤neas
                        var lineasTexto = pdf.splitTextToSize(textoCarta, 180);

                        // Definir la posici칩n inicial para el texto
                        var y = 100;

                        // Iterar sobre las l칤neas de texto
                        lineasTexto.forEach(function (linea) {
                            // Agregar la l칤nea de texto al PDF con justificaci칩n
                            pdf.text(linea, 20, y, { align: 'justify' });
                            // Aumentar la posici칩n Y para la siguiente l칤nea de texto
                            y += 10; // Espacio entre l칤neas
                        });

                        // Agregar el segundo texto
                        var segundoTexto = "Chief Information Officer";
                        pdf.setFont("times"); // Establecer la fuente normal
                        pdf.setFontSize(12); // Tama침o de fuente normal para el segundo texto
                        var xSegundoTexto = pdf.internal.pageSize.width / 2 - 22; // Mover el texto 50 unidades hacia la izquierda
                        pdf.text(segundoTexto, xSegundoTexto, y + 27, { align: 'center' }); // Espacio adicional despu칠s del nombre

                        // Agregar el nombre del Licenciado en negrita y centrado
                        var nombreLic = "LIC. ENEL R. ALMONTE P.";
                        pdf.setFont("times", "bold"); // Establecer la fuente en negrita
                        pdf.setFontSize(14); // Tama침o de fuente m치s grande para el nombre
                        var xNombre = pdf.internal.pageSize.width / 2 - 30; // Mover el texto 10 unidades hacia la izquierda
                        pdf.text(nombreLic, xNombre, y + 20, { align: 'center' }); // Espacio adicional despu칠s del contenido de la carta

                        // Guardar el PDF despu칠s de que se hayan agregado todas las im치genes y texto
                        pdf.save('CertificadoDePasante.pdf');

                        console.log(pasantejson);
                    };
                };
            };
        }

        function formatDate(date) {
         
            var day = date.getDate();
            var month = date.getMonth() + 1; 
            var year = date.getFullYear();

            var formattedDate = (day < 10 ? '0' : '') + day + "-" + (month < 10 ? '0' : '') + month + "-" + year; 

            return formattedDate;
        }

        function formatMonthAndYear(date) {
            var months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
            var month = months[date.getMonth()];
            var year = date.getFullYear();

            var formattedDate = month + " " + year;

            return formattedDate;
        }


    </script>






    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>



















    <script src="_content/Radzen.Blazor/Radzen.Blazor.js"></script>

</body>

</html>
